<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CryptoGlass Hacker Classic</title>
    <style>
        :root {
            --neon: #00f2fe;
            --neon-pink: #ff007f;
            --glass: rgba(255, 255, 255, 0.03);
            --border: rgba(0, 242, 254, 0.2);
            --success: #22c55e;
        }

        body {
            background: #05070a;
            color: #e2e8f0;
            font-family: 'Courier New', Courier, monospace;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            overflow: hidden;
        }

        .bg-blob {
            position: absolute; width: 600px; height: 600px;
            background: radial-gradient(circle, var(--neon) 0%, transparent 70%);
            filter: blur(100px); z-index: -1; opacity: 0.05;
            animation: pulse 10s infinite alternate;
        }

        @keyframes pulse { from { transform: scale(1); } to { transform: scale(1.2); } }

        .app-card {
            width: 100%; max-width: 450px;
            background: rgba(10, 15, 25, 0.9); backdrop-filter: blur(40px);
            border: 1px solid var(--border); border-radius: 24px;
            padding: 35px; box-shadow: 0 0 40px rgba(0, 242, 254, 0.15);
        }

        h2 { text-align: center; letter-spacing: 5px; color: var(--neon); text-transform: uppercase; margin-top: 0; }

        .box { margin-bottom: 20px; }
        label { font-size: 10px; text-transform: uppercase; color: #64748b; margin-bottom: 8px; display: block; letter-spacing: 2px; }

        textarea, input {
            width: 100%; background: rgba(0, 0, 0, 0.6);
            border: 1px solid var(--border); border-radius: 12px;
            padding: 15px; color: var(--neon); font-family: monospace;
            resize: none;
        }

        .actions { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }

        button {
            padding: 14px; border-radius: 10px; border: none; cursor: pointer;
            font-weight: bold; text-transform: uppercase; font-size: 10px;
            transition: 0.2s; font-family: monospace;
        }

        .btn-encrypt { background: var(--neon); color: #000; }
        .btn-decrypt { background: transparent; border: 1px solid var(--neon); color: var(--neon); }
        .btn-special { grid-column: span 2; margin-top: 10px; display: none; }
        .btn-copy { background: #6366f1; color: white; }
        .btn-reply { background: var(--success); color: white; }

        #result-container {
            margin-top: 25px; padding: 20px;
            background: rgba(0, 0, 0, 0.8); border: 1px solid var(--neon);
            border-radius: 12px; display: none; position: relative;
        }

        #timer-display { position: absolute; top: 10px; right: 10px; font-size: 10px; color: var(--neon-pink); font-weight: bold; }
        #result-text { word-break: break-all; font-size: 14px; color: #fff; text-shadow: 0 0 5px var(--neon); line-height: 1.4; }
    </style>
</head>
<body>

    <div class="bg-blob"></div>

    <div class="app-card">
        <h2>SISTEMA_CRIPTO</h2>
        
        <div class="box">
            <label>DATI_SORGENTE</label>
            <textarea id="main-input" rows="4" placeholder="Inserisci testo o codice..."></textarea>
        </div>

        <div class="box">
            <label>CHIAVE_DI_ACCESSO</label>
            <input type="password" id="pass-key" placeholder="Password segreta">
        </div>

        <div class="actions">
            <button class="btn-encrypt" onclick="process(true)">Cripta</button>
            <button class="btn-decrypt" onclick="process(false)">Decripta</button>
            
            <button id="copy-btn" class="btn-special btn-copy" onclick="copyToClipboard()">ðŸ“‹ COPIA CODICE</button>
            <button id="reply-btn" class="btn-special btn-reply" onclick="setupReply()">â†© RISPONDI</button>
        </div>

        <div id="result-container">
            <div id="timer-display"></div>
            <label id="result-label">RISULTATO:</label>
            <div id="result-text"></div>
        </div>
    </div>

    <script>
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

        function playBeep(freq = 400, duration = 0.05) {
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.type = "square";
            osc.frequency.value = freq;
            gain.gain.value = 0.05;
            osc.connect(gain); gain.connect(audioCtx.destination);
            osc.start(); osc.stop(audioCtx.currentTime + duration);
        }

        function hackerReveal(element, finalText, isDecrypt) {
            const chars = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ#$@&*%";
            let iteration = 0;
            const interval = setInterval(() => {
                element.innerText = finalText.split("").map((char, index) => {
                    if(index < iteration) return finalText[index];
                    return chars[Math.floor(Math.random() * chars.length)];
                }).join("");
                
                if (iteration % 1 === 0) playBeep(600 + (iteration * 10), 0.02);

                if(iteration >= finalText.length) {
                    clearInterval(interval);
                    playBeep(800, 0.1);
                    if(isDecrypt) startSelfDestruct();
                }
                iteration += 1 / 3;
            }, 30);
        }

        function startSelfDestruct() {
            let timeLeft = 30;
            const countdown = setInterval(() => {
                timeLeft--;
                document.getElementById('timer-display').innerText = `DISTRUZIONE: ${timeLeft}s`;
                if(timeLeft <= 0) {
                    clearInterval(countdown);
                    document.getElementById('result-text').innerText = "[DATI CANCELLATI]";
                    document.getElementById('timer-display').innerText = "ELIMINATO";
                    playBeep(100, 0.5);
                }
            }, 1000);
        }

        function cryptEngine(text, key, isEncrypt) {
            try {
                if (isEncrypt) {
                    let out = "";
                    for (let i = 0; i < text.length; i++) {
                        out += String.fromCharCode(text.charCodeAt(i) ^ key.charCodeAt(i % key.length));
                    }
                    return btoa(out);
                } else {
                    let decoded = atob(text.trim());
                    let out = "";
                    for (let i = 0; i < decoded.length; i++) {
                        out += String.fromCharCode(decoded.charCodeAt(i) ^ key.charCodeAt(i % key.length));
                    }
                    return out;
                }
            } catch (e) { return "ERRORE_DATI_CORROTTI"; }
        }

        function process(isEncrypt) {
            const input = document.getElementById('main-input').value;
            const key = document.getElementById('pass-key').value;
            const resContainer = document.getElementById('result-container');
            const resText = document.getElementById('result-text');
            if(!input || !key) return;
            if (audioCtx.state === 'suspended') audioCtx.resume();

            const result = cryptEngine(input, key, isEncrypt);
            resContainer.style.display = "block";
            document.getElementById('timer-display').innerText = "";
            
            hackerReveal(resText, result, !isEncrypt);

            if(isEncrypt) {
                document.getElementById('copy-btn').style.display = "block";
                document.getElementById('reply-btn').style.display = "none";
                document.getElementById('result-label').innerText = "CODICE DA INVIARE:";
            } else {
                document.getElementById('copy-btn').style.display = "none";
                document.getElementById('reply-btn').style.display = "block";
                document.getElementById('result-label').innerText = "MESSAGGIO RICEVUTO:";
            }
        }

        function copyToClipboard() {
            const text = document.getElementById('result-text').innerText;
            navigator.clipboard.writeText(text).then(() => {
                const btn = document.getElementById('copy-btn');
                btn.innerText = "COPIATO!";
                playBeep(1000, 0.1);
                setTimeout(() => btn.innerText = "ðŸ“‹ COPIA CODICE", 2000);
            });
        }

        function setupReply() {
            document.getElementById('main-input').value = "";
            document.getElementById('result-container').style.display = "none";
            document.getElementById('main-input').focus();
        }
    </script>
</body>

</html>
